<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MARKER</title>

    <link rel="preload" href="./assets/fonts/Presicav.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="./assets/fonts/Calibre-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="./assets/fonts/Arial.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap"
        rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=neue-montreal@500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.ui.min.js"></script>
    
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

    <script type="module" crossorigin="" src="./js/index.min.js?v=1754734869502"></script>
    <link rel="stylesheet" crossorigin="" href="./css/index.min.css?v=1754734869502">

    <style>
        /* =========================================
           GLOBAL & ANIMATIONS
           ========================================= */
        @keyframes stroke { from { stroke-dashoffset: 5414.29; } to { stroke-dashoffset: 0; } }
        @keyframes reveal { from { clip-path: polygon(0 100%, 100% 100%, 100% 100%, 0% 100%); opacity: 0; } }
        @keyframes scaleIn { from { opacity: 0; scale: .2; } }
        @keyframes revealText { from { clip-path: polygon(0 0, 0% 0, 0% 100%, 0 100%); } }

        html { background-color: rgb(255, 255, 255); }
        body { margin: 0; overflow-x: hidden; overscroll-behavior: none; }
        body.is-loading { overflow: hidden; height: 100vh; }

        /* =========================================
           GLOBAL CURSOR STYLES
           ========================================= */
        #global-cursor-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 10000;
            pointer-events: none;
            mix-blend-mode: difference;
        }

        /* =========================================
           3D MARKER CANVAS STYLES
           ========================================= */
        #marker-3d-canvas {
            position: fixed;
            top: 50%;
            right: 0vw; 
            transform: translateY(-50%);
            width: 80vh;
            height: 80vh;
            z-index: 5; /* Below text (10), Above video (0) */
            pointer-events: none;
            background: transparent;
            transition: opacity 0.1s linear; /* Smooth fade helper */
        }

        .page-header {
            align-items: center;
            display: flex;
            height: 100vh;
            justify-content: center;
            background: transparent;
        }

        .page-header h1 { color: white; font-size: 3rem; }

        /* =========================================
           LOADER STYLES
           ========================================= */
        .loader-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #f4f4f4;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-family: 'Neue Montreal', sans-serif;
        }

        .loader-content {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            position: relative;
        }

        .willem__h1 {
            white-space: nowrap;
            justify-content: center;
            font-size: clamp(3rem, 12vw, 12.5em);
            font-weight: 500;
            line-height: .75;
            display: flex;
            position: relative;
            color: #201d1d;
        }

        .willem__h1-start, .willem__h1-end { display: flex; overflow: hidden; }
        .willem__h1-start { justify-content: flex-end; width: auto; }
        .willem__h1-end { justify-content: flex-start; width: auto; }
        .willem__letter { display: block; position: relative; }

        .willem-loader__box {
            flex-flow: column;
            justify-content: center;
            align-items: center;
            width: 0;
            display: flex;
            position: relative;
            margin: 0 0.1em;
        }

        .willem-loader__box-inner {
            justify-content: center;
            align-items: center;
            min-width: 1em;
            height: 95%;
            display: flex;
            position: relative;
        }

        .willem__growing-image {
            justify-content: center;
            align-items: center;
            width: 0%;
            height: 100%;
            display: flex;
            position: absolute;
            overflow: hidden;
        }

        .willem__growing-image-wrap {
            width: 100%;
            min-width: 1em;
            height: 100%;
            position: absolute;
        }

        .willem__cover-image, .willem__cover-image-extra {
            pointer-events: none;
            object-fit: cover;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .willem__cover-image-extra.is--1 { z-index: 3; }
        .willem__cover-image-extra.is--2 { z-index: 2; }
        .willem__cover-image-extra.is--3 { z-index: 1; }

        /* =========================================
           SECTION 2: URBANIST STYLES
           ========================================= */
        :root {
            --theme-main-bg: #b9dcff;
            --theme-sub-bg: #f2fbfe;
            --theme-text: #070f36;
            --theme-title: #8dc9f4;
            --font-sans: "Urbanist", sans-serif;
        }

        #urbanist-integration {
            position: relative;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            font-family: var(--font-sans);
            color: var(--theme-text);
            isolation: isolate;
            z-index: 20;
            background: white;
        }

        #urbanist-integration .urbanist-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            object-fit: cover;
        }

        #urbanist-integration .content-layer {
            position: absolute;
            inset: 0;
            padding-inline: min(10vw, 100px);
            z-index: 1;
            pointer-events: none;
        }

        #urbanist-integration h1 {
            font-size: clamp(10vw, 250px, 20vw);
            color: var(--theme-title);
            margin: 0;
            line-height: 1;
        }

        #urbanist-integration p {
            width: clamp(5vw, 250px, 80vw);
            font-size: clamp(1vw, 12px, 1.5vw);
            font-weight: 600;
            text-wrap: balance;
            color: var(--theme-text);
            line-height: 1.3;
        }

        #urbanist-integration .desc-1 { margin-top: 2rem; }
        #urbanist-integration .desc-2 { position: absolute; bottom: 5vh; left: min(40vw, 300px); }
        #urbanist-integration .desc-3 { position: absolute; top: 50%; right: 10vw; }

        #panes-container { width: 300vw; display: flex; height: 100%; }
        .pane { position: relative; height: 100%; width: 100vw; }

        .urbanist-floating-img {
            position: absolute;
            right: 0;
            top: 50%;
            width: max(20vw, 400px);
            translate: -100% 0;
            border-radius: 12px;
            display: block;
        }

        .pane:nth-of-type(2) .urbanist-floating-img {
            aspect-ratio: 1/1;
            object-fit: cover;
            translate: -200% -70%;
            width: max(15vw, 300px);
        }

        .pane:nth-of-type(3) .urbanist-floating-img { translate: -150% -50%; }

        /* =========================================
           SECTION 3: HISTORY STYLES
           ========================================= */
        #scroll-section {
            container: inline-size;
            display: grid;
            position: relative;
            min-height: 1800px;
            padding-block-start: 15vh;
            font-family: 'Montserrat', sans-serif;
            background: transparent;
            z-index: 10;
        }

        #scroll-section img {
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
            display: block;
            height: auto;
            max-width: 100%;
            animation: reveal linear both;
            animation-timeline: view();
            animation-range: 10% 60%;
        }

        #scroll-section .btn {
            background-color: rgb(21, 21, 21);
            border-radius: 99px;
            color: white;
            display: block;
            font-size: 18px;
            font-weight: 900;
            letter-spacing: .02em;
            line-height: 42px;
            height: 42px;
            padding: 0 40px;
            text-decoration: none;
            transition: background-color .4s ease-out;
            width: fit-content;
        }

        #scroll-section .btn:hover { background-color: rgb(243, 87, 87); }

        .line-svg {
            grid-row: 1;
            grid-column: 1;
            height: calc(100% - 10rem);
            top: 25cqb;
            min-width: 300px;
            z-index: 1;
            pointer-events: none;
        }

        .anim-overview-stroke {
            stroke-dasharray: 5414.29;
            stroke-dashoffset: 5414.29;
            animation: stroke linear forwards;
            animation-timeline: view();
            animation-range: cover 0% cover 75%;
        }

        .container {
            grid-column: 1;
            grid-row: 1;
            margin: 0 auto;
            max-width: 1272px;
            z-index: 2;
        }

        #scroll-section h2 {
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
            color: #333;
            font-size: 62px;
            font-weight: 900;
            letter-spacing: .02em;
            margin: 0;
            padding-top: 72px;
            position: relative;
            width: 50%;
            text-align: right;
            animation: revealText linear both;
            animation-timeline: view();
            animation-range: 25% 60%;
        }

        .layout-container {
            padding-top: 8rem;
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 20px;
        }

        .box {
            background-color: rgb(255, 239, 239);
            color: #333;
            padding: 4rem;
            opacity: 1;
            scale: 1;
            animation: scaleIn linear both;
            animation-timeline: view();
            animation-range: 0% 40vh;
        }

        .box h3 {
            font-size: 42px;
            font-weight: 900;
            line-height: 1.1;
            margin: 0 0 18px;
        }

        .box p {
            font-size: 18px;
            line-height: 1.25;
            margin: 0 0 2em;
        }

        .box-1 { grid-column: 3 / span 3; grid-row: span 2; }
        .image-1 { grid-column: 1 / span 2; grid-row: 2 / span 2; margin-top: 100px; }
        .image-2 { align-self: end; grid-column: 6 / span 1; grid-row: 5; }
        .image-3 { grid-column: 1 / span 2; justify-self: end; margin-top: 3rem; }
        .box-2 { grid-column: 2 / span 3; margin-top: 3rem; grid-row: span 2; }
        .box-3 { grid-column: 3 / span 3; margin-top: 8em; }
        .box-4 { grid-column: 1 / span 3; margin-top: 12rem; margin-bottom: -5rem; }

        .bottom-spacer { height: 10vh; }

        /* =========================================
           SECTION 4: PERSPECTIVE ZOOM STYLES
           ========================================= */
        #perspective-wrap {
            background-color: #1f1f1f;
            color: #ffffff;
            font-family: "Roboto", sans-serif;
            position: relative;
            z-index: 30;
        }

        .zoom-container {
            height: 100vh;
            width: 100%;
            overflow: hidden;
            position: relative;
            perspective: 100vh;
            transform-style: preserve-3d;
            background-color: #1f1f1f;
        }

        .heading-zoom {
            font-size: clamp(3rem, 5vw, 6rem);
            line-height: 1.1;
            text-align: center;
            opacity: 0;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) translateZ(-2000px);
            white-space: nowrap;
            z-index: 10;
            pointer-events: none;
            font-weight: 900;
            text-transform: uppercase;
            color: white;
        }

        .zoom-item {
            position: absolute;
            transform-style: preserve-3d;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .zoom-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .zoom-item:nth-child(2) { left: 15vw; top: 21%; width: 15vw; }
        .zoom-item:nth-child(3) { left: 29%; top: 15%; width: 12vw; }
        .zoom-item:nth-child(4) { left: 36%; top: 3%; width: 15vw; }
        .zoom-item:nth-child(5) { right: 30%; top: 11%; width: 10vw; }
        .zoom-item:nth-child(6) { right: 7%; top: 28%; width: 18vw; }
        .zoom-item:nth-child(7) { bottom: 32%; right: 3.5%; width: 8vw; }
        .zoom-item:nth-child(8) { bottom: 13.5%; left: 16%; width: 14vw; }
        .zoom-item:nth-child(9) { bottom: 24%; left: 29%; width: 9vw; }
        .zoom-item:nth-child(10) { bottom: 46%; left: 7.5%; width: 8vw; }
        .zoom-item:nth-child(11) { bottom: 5.5%; right: 15%; width: 18vw; }
        .zoom-item:nth-child(12) { bottom: 10.5%; right: 38%; width: 12vw; }
        .zoom-item:nth-child(13) { right: 4%; top: 5%; width: 9vw; }

        .section-stick {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: black;
            color: white;
            position: relative;
            z-index: 50;
        }

        .reveal-text-style {
            font-size: 3rem;
            text-align: center;
            width: 80%;
            font-weight: 700;
            line-height: 1.25;
            color: white;
        }

        @media (min-width: 768px) {
            .reveal-text-style { font-size: 4.5rem; }
        }

        .opacity-reveal { opacity: 0.2; }
        .opacity-reveal span { transition: opacity 0.1s; }
        .spacer-black { height: 50vh; background: #000; }

        /* =========================================
           SECTION 5: ALICE INTEGRATION STYLES
           ========================================= */
        #alice-wrapper {
            --font-open-sans: "Open Sans", serif;
            --color-white: hsla(0, 0%, 100%, 1);
            --color-black: hsla(0, 0%, 0%, 1);
            font-family: var(--font-open-sans);
            font-size: 1rem;
            line-height: 1.75;
            background-color: var(--color-white);
            color: var(--color-black);
            position: relative;
            z-index: 60;
        }

        #alice-wrapper .intro {
            align-items: center;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        #alice-wrapper .intro__heading {
            font-size: clamp(1.875rem, 8.083vw + -0.217rem, 6.25rem);
            line-height: clamp(2.813rem, 9.815vw + 0.273rem, 8.125rem);
            text-align: center;
            margin: 0;
        }

        #alice-wrapper .content {
            background-color: white;
            display: flex;
            justify-content: center;
            position: relative;
            z-index: 1;
            padding: 6.25rem 0;
        }

        #alice-wrapper .article { max-width: 31.25rem; padding: 0 1.5rem; }

        #alice-wrapper .hero-reveal {
            background-color: var(--color-black);
            position: relative;
            min-height: 100vh;
            overflow: hidden;
        }

        #alice-wrapper .hero-reveal__header {
            align-items: center;
            background-color: var(--color-white);
            color: var(--color-black);
            display: flex;
            font-size: clamp(3.125rem, 12.61vw + -0.138rem, 15.625rem);
            line-height: clamp(4.688rem, 15.763vw + 0.609rem, 20.313rem);
            font-weight: 900;
            justify-content: center;
            left: 0;
            min-height: 100vh;
            position: relative;
            top: 0;
            will-change: transform, clip-path;
            z-index: 1;
            width: 100%;
        }

        #alice-wrapper .hero-reveal_split {
            align-items: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            width: 100%;
            height: 100%;
        }

        #alice-wrapper .hero-reveal_split_item {
            align-items: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 100vh;
            width: 100%;
            margin: 0;
        }

        #alice-wrapper .hero-reveal_split_item p { margin: 0; }
        #alice-wrapper .hero-reveal_split_item:nth-child(1) { clip-path: inset(0 0 50% 0); }
        #alice-wrapper .hero-reveal_split_item:nth-child(2) { clip-path: inset(50% 0 0 0); left: 0; position: absolute; top: 0; }

        #alice-wrapper .hero-reveal__content {
            color: var(--color-white);
            display: flex;
            justify-content: center;
            padding: 0;
            position: relative;
            margin-top: -60vh;
            pointer-events: none;
        }

        #alice-wrapper .hero-reveal__content-inner {
            max-width: 31.25rem;
            position: relative;
            padding: 0 1.5rem;
        }

        #alice-wrapper .hero-reveal__content-p {
            padding-bottom: 8rem;
            position: relative;
            z-index: 2;
        }

        #alice-wrapper .hero-reveal__parallax {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        #alice-wrapper .hero-reveal__parallax img {
            position: absolute;
            will-change: transform;
        }

        #alice-wrapper .hero-reveal__parallax-clock { left: -6rem; top: -25rem; }
        #alice-wrapper .hero-reveal__parallax-book { left: -12.5rem; top: -25rem; }
        #alice-wrapper .hero-reveal__parallax-alice { left: 50%; transform: translateX(-50%); top: -31.25rem; max-width: 200px; }
        #alice-wrapper .hero-reveal__parallax-kattle { left: 31.25rem; filter: blur(2px); top: -18.75rem; }
        #alice-wrapper .hero-reveal__parallax-card { left: 25rem; filter: blur(2px); z-index: 1; top: -25rem; }

        /* =========================================
           LOGO STYLES
           ========================================= */
        .header__menu h1.logo { margin: 0; line-height: 1; }
        .header__menu h1.logo a {
            font-family: 'Roboto', sans-serif;
            font-weight: 900;
            font-size: 2.25rem;
            color: white;
            text-decoration: none;
            letter-spacing: -0.04em;
            text-transform: uppercase;
            display: inline-block;
            transition: color 0.3s ease, transform 0.3s ease;
        }
        .header__menu h1.logo a:hover { color: var(--theme-title, #e0e0e0); }

        /* =========================================
           SECTION 6: CAROUSEL STYLES
           ========================================= */
        #carousel-section {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: rgb(211, 216, 203);
            z-index: 70;
        }

        #carousel-section .slider {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        #carousel-section .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
            background: #dbdbdb;
            overflow: hidden;
            will-change: clip-path;
        }

        #slide-1 { z-index: 1; clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%); }
        #slide-2 { z-index: 2; clip-path: polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%); }
        #slide-3 { z-index: 3; clip-path: polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%); }
        #slide-4 { z-index: 4; clip-path: polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%); }

        #carousel-section .slide.dark { background: #0c0c0c; }
        #carousel-section .slide.light { background: #dbdbdb; }

        #carousel-section .slide-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
            pointer-events: none;
        }

        #carousel-section .slide-content h1 {
            font-family: 'Roboto', sans-serif;
            font-size: 15vw;
            text-transform: uppercase;
            font-weight: 900;
            color: #000;
            margin: 0;
            line-height: 0.9;
        }

        #carousel-section .slide.dark .slide-content h1 { color: #dbdbdb; }

        #carousel-section .slide-img {
            position: absolute;
            width: 250px;
            height: 150vh;
            filter: saturate(0);
        }

        #carousel-section .slide-img img {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 250px;
            height: 600px;
            object-fit: cover;
        }

        #carousel-section .slide-img-1 { top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-20deg); }
        #carousel-section .slide-img-2 { top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(20deg); }

        .scroll-hint {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Urbanist', sans-serif;
            color: #888;
            font-size: 0.8rem;
            z-index: 20;
            pointer-events: none;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* =========================================
           SECTION 7: LIQUID BACKGROUND STYLES
           ========================================= */
        #liquid-section {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background-color: #000;
            z-index: 80;
        }

        #liquid-canvas { width: 100%; height: 100%; display: block; }

        .liquid-overlay {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            pointer-events: auto;
        }

        .liquid-overlay a {
            color: #fff;
            text-decoration: none;
            text-shadow: 1px 1px 2px black;
            font-family: 'Montserrat', sans-serif;
        }

        /* =========================================
           SECTION 8: ADVANCED FOOTER STYLES
           ========================================= */
        #advanced-footer {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-color: #050505;
            color: white;
            z-index: 90;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Neue Montreal', sans-serif;
        }

        #footer-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        .footer-content {
            position: relative;
            z-index: 2;
            width: 100%;
            max-width: 1400px;
            padding: 0 4vw;
            display: grid;
            grid-template-columns: 1fr 1fr;
            height: 100%;
            align-content: center;
        }

        .footer-left {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 60vh;
        }

        .footer-big-text {
            font-size: 12vw;
            line-height: 0.8;
            font-weight: 500;
            margin: 0;
            letter-spacing: -0.04em;
            text-transform: uppercase;
            opacity: 0;
            transform: translateY(50px);
        }

        .footer-right {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: flex-end;
            text-align: right;
            height: 60vh;
            font-size: 1.25rem;
        }

        .footer-links { display: flex; gap: 4rem; }
        .footer-links ul { list-style: none; padding: 0; margin: 0; }
        .footer-links li { margin-bottom: 0.5rem; overflow: hidden; }
        .footer-links a {
            color: #888;
            text-decoration: none;
            display: inline-block;
            transition: color 0.3s, transform 0.3s;
            transform: translateY(100%);
        }
        .footer-links a:hover { color: #fff; transform: translateX(-10px); }

        .footer-bottom {
            display: flex;
            justify-content: space-between;
            width: 100%;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 2rem;
            margin-top: auto;
            grid-column: span 2;
            opacity: 0;
        }

        /* =========================================
           RESPONSIVE MEDIA QUERIES (NEW ADDITION)
           ========================================= */

        @media (max-width: 1024px) {
            #scroll-section h2 { width: 80%; font-size: 48px; }
            .container { padding: 0 2rem; }
        }

        @media (max-width: 768px) {
            .hero__title, .hero__title span { font-size: 15vw !important; }
            .header__menu h1.logo a { font-size: 1.5rem; }
            #scroll-section { padding-block-start: 5vh; }
            .line-svg { display: none; }
            .layout-container { display: flex; flex-direction: column; gap: 40px; padding-top: 4rem; }
            .box-1, .box-2, .box-3, .box-4, .image-1, .image-2, .image-3 {
                grid-column: auto; grid-row: auto; margin: 0 !important; width: 100%; box-sizing: border-box;
            }
            .image-2, .image-3 { justify-self: center; align-self: center; }
            #scroll-section h2 { width: 100%; text-align: center; font-size: 36px; padding-top: 20px; }
            .box { padding: 2rem; }
            .box h3 { font-size: 32px; }
            #urbanist-integration .content-layer { padding-inline: 5vw; display: flex; flex-direction: column; justify-content: center; }
            #urbanist-integration h1 { font-size: 18vw; }
            #urbanist-integration p { width: 90vw; font-size: 16px; }
            #urbanist-integration .desc-2, #urbanist-integration .desc-3 {
                position: relative; bottom: auto; left: auto; right: auto; top: auto; margin-top: 1.5rem;
            }
            .urbanist-floating-img {
                width: 50vw; top: 75%; left: 50%; right: auto; translate: -50% -50% !important;
            }
            .pane:nth-of-type(2) .urbanist-floating-img, .pane:nth-of-type(3) .urbanist-floating-img {
                translate: -50% -50% !important;
            }
            .heading-zoom { font-size: 3rem; }
            .zoom-container { background-color: white; }
            .zoom-item { width: 40vw !important; max-height: 30vh; }
            .zoom-item:nth-child(2) { left: 5%; top: 15%; }
            .zoom-item:nth-child(3) { left: 55%; top: 10%; }
            .zoom-item:nth-child(4) { left: 10%; top: 60%; }
            .zoom-item:nth-child(5) { right: 5%; top: 40%; }
            .zoom-item:nth-child(6) { right: 50%; top: 80%; }
            .reveal-text-style { font-size: 1.8rem; width: 90%; }
            .section-stick { margin-bottom: -1100px; }
            #carousel-section .slide-content h1 { font-size: 20vw; }
            #carousel-section .slide-img { width: 200px; height: 100vh; }
            #carousel-section .slide-img img { width: 200px; height: 400px; }
            .footer-content { grid-template-columns: 1fr; gap: 2rem; padding-top: 2rem; }
            .footer-left { height: auto; text-align: center; align-items: center; }
            .footer-right { height: auto; align-items: center; text-align: center; }
            .footer-big-text { font-size: 18vw; }
            .footer-links { flex-direction: column; gap: 2rem; margin-top: 2rem; }
            .footer-bottom { flex-direction: column; gap: 1rem; text-align: center; padding-bottom: 2rem; }
            #alice-wrapper .intro__heading { font-size: 3rem; }
            #alice-wrapper .hero-reveal__header { font-size: 4rem; }
            
            /* Responsive Marker Adjustment */
            #marker-3d-canvas {
                width: 60vh;
                height: 60vh;
                right: -10vw; /* Push slightly off screen for mobile */
                top: 60%; /* Lower it slightly */
            }
        }
    </style>
</head>

<body class="is-loading">

    <canvas id="global-cursor-canvas"></canvas>
    
    <model-viewer 
        id="marker-3d-canvas" 
        src="office-decor-organiser-pen/source/office_decor_organiser_pen (1).glb" 
        alt="3D Marker Pen" 
        auto-rotate 
        camera-controls 
        disable-zoom
        shadow-intensity="1"
        style="width: 80vh; height: 80vh;">
    </model-viewer>

    <section class="loader-screen">
        <div class="loader-content">
            <div class="willem__h1">
                <div class="willem__h1-start">
                    <span class="willem__letter">M</span>
                    <span class="willem__letter">A</span>
                    <span class="willem__letter">R</span>
                </div>
                <div class="willem-loader__box">
                    <div class="willem-loader__box-inner">
                        <div class="willem__growing-image">
                            <div class="willem__growing-image-wrap">
                                <img class="willem__cover-image-extra is--1" src="marker1.jpg" loading="lazy" alt="">
                                <img class="willem__cover-image-extra is--2" src="marker2.jpeg" loading="lazy" alt="">
                                <img class="willem__cover-image-extra is--3" src="marker3.webp" loading="lazy" alt="">
                                <img class="willem__cover-image" src='image.png' loading="lazy" alt="">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="willem__h1-end">
                    <span class="willem__letter">K</span>
                    <span class="willem__letter">E</span>
                    <span class="willem__letter">R</span>
                </div>
            </div>
        </div>
    </section>

    <div class="wrapper">
        <header class="header fade" data-fls-header="" data-fls-header-scroll="" data-fls-header-scroll-show="">
            <div class="header__container">
                <div class="header__menu menu">
                    <h1 class="logo">
                        <a href="#">MARKER</a>
                    </h1>
                </div>
            </div>
        </header>

        <main class="page page--home">

            <section class="hero">
                <video class="hero__video" src="./files/banner-hero.mov" autoplay muted loop playsinline=""></video>
                <canvas class="hero__canvas" id="hero-canvas"></canvas>
                <h1 class="hero__title" data-fls-watcher="" data-fls-watcher-once="">
                    <span>MARKER</span>
                </h1>
            </section>

            <section id="scroll-section">
                <svg class="line-svg" role="presentational" preserveAspectRatio="xMidYMin slice" width="100%"
                    fill="none" viewBox="-480 0 2300 2241">
                    <path class="anim-overview-stroke" stroke="#B1EAFB" stroke-width="60"
                        d="M-841 100H584c124 0 225 101 225 225v0c0 124-101 225-225 225h-95a281 281 0 00-281 281v0c0 155 125 281 281 281h442c167 0 304 136 304 304v0c0 168-137 304-304 304H795a439 439 0 00-439 439v82"
                        opacity=".75"></path>
                </svg>
                <div class="container">
                    <h2>THE JOURNEY</h2>
                    <div class="layout-container">

                        <div class="box box-1">
                            <h3>The Inception</h3>
                            <p>It started with a simple observation: the digital world was becoming too clean. We craved
                                the raw, unpolished energy of a fresh permanent marker stroke against a blank page.</p>
                            <a href="#" class="btn">Read the story</a>
                        </div>

                        <img class="image-1"
                            src="https://images.unsplash.com/photo-1513364776144-60967b0f800f?q=80&w=800&auto=format&fit=crop"
                            width="400" height="400" alt="Artist sketching with marker" />

                        <div class="box box-2">
                            <h3>Analog Roots</h3>
                            <p>We spent months digitizing thousands of hand-drawn lines, preserving every bleed, rough
                                edge, and imperfection. The goal was to capture the authentic friction of felt tip on
                                cardboard.</p>
                            <a href="#" class="btn">View process</a>
                        </div>

                        <img class="image-2"
                            src="https://images.unsplash.com/photo-1541963463532-d68292c34b19?q=80&w=800&auto=format&fit=crop"
                            width="400" height="600" alt="Ink texture details" />

                        <div class="box box-3">
                            <h3>Breaking Grids</h3>
                            <p>Marker serves as a tool for digital rebellion. It refuses to whisper, demanding attention
                                by breaking rigid layout grids with organic flow and undeniable human presence.</p>
                            <a href="#" class="btn">Our philosophy</a>
                        </div>

                        <img src="image3.jpg" class="image-3" width="400" height="400" alt="Urban creative space" />

                        <div style="margin-bottom: 20px;" class="box box-4">
                            <h3>A New Standard</h3>
                            <p>Today, Marker isn't just a typeface; it is a movement. Used by creators worldwide to
                                inject personality into the pixelated void, turning standard headings into visual
                                statements.</p>
                            <a href="#" class="btn">Join the movement</a>
                        </div>
                    </div>
                </div>
            </section>
            <section id="urbanist-integration">
                <svg class="urbanist-bg" width="100%" viewBox="0 0 1920 1300" fill="none"
                    xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
                    <rect width="1920" height="1300" fill="url(#gradient)"></rect>
                    <defs>
                        <linearGradient id="gradient" x1="1300.54" y1="201.621" x2="959.727" y2="841.863"
                            gradientUnits="userSpaceOnUse">
                            <stop offset="0.15" stop-color="var(--theme-sub-bg)" stop-opacity="1"></stop>
                            <stop offset="0.85" stop-color="var(--theme-main-bg)"></stop>
                        </linearGradient>
                    </defs>
                </svg>

                <div class="content-layer">
                    <h1>Marker</h1>
                    <p class="desc-1">
                        The Marker font captures the spontaneous energy and look of a broad-tipped permanent
                        marker, offering a bold and authentic hand-drawn aesthetic for digital interfaces.
                    </p>
                    <p class="desc-2">
                        Characterized by its irregular edges, organic flow, and varying stroke weights, it
                        breaks away from rigid digital grids to deliver a raw, human touch.
                    </p>
                    <p class="desc-3">
                        Ideal for impactful headlines and creative overlays, this typeface transforms
                        standard typography into expressive, attention-grabbing visual statements.
                    </p>
                </div>

                <div id="panes-container">
                    <div class="pane">
                        <img class="urbanist-floating-img" src="blue.png" alt="Marker design inspiration 1">
                    </div>
                    <div class="pane">
                        <img class="urbanist-floating-img" src="orange.png" alt="Marker design inspiration 2">
                    </div>
                    <div class="pane">
                        <img class="urbanist-floating-img" src="green.png" alt="Marker design inspiration 3">
                    </div>
                </div>
            </section>
            <section class="bottom-spacer"></section>

            <div style="background-color: white;" id="perspective-wrap">
                <div style="background-color: white;" class="zoom-container">
                    <h1 class="heading-zoom" style="color: rgb(43, 43, 43);">MARKER ARTS<br /></h1>

                    <div class="zoom-item" data-layer="2">
                        <img src="https://images.unsplash.com/photo-1620619767323-b95a89183081?q=80&w=600&auto=format&fit=crop"
                            alt="Abstract colored markers">
                    </div>
                    <div class="zoom-item" data-layer="2">
                        <img src="https://images.unsplash.com/photo-1543857778-c4a1a3e0b2eb?q=80&w=600&auto=format&fit=crop"
                            alt="Black ink splatter">
                    </div>
                    <div class="zoom-item" data-layer="1">
                        <img src="https://images.unsplash.com/photo-1511447333015-45b65e60f6d5?q=80&w=600&auto=format&fit=crop"
                            alt="Hand sketching with marker">
                    </div>
                    <div class="zoom-item" data-layer="2">
                        <img src="https://images.unsplash.com/photo-1620619767323-b95a89183081?q=80&w=600&auto=format&fit=crop"
                            alt="Vibrant marker strokes">
                    </div>
                    <div class="zoom-item" data-layer="3">
                        <img src="https://images.unsplash.com/photo-1550684848-fac1c5b4e853?q=80&w=600&auto=format&fit=crop"
                            alt="Neon marker texture">
                    </div>
                    <div class="zoom-item" data-layer="1">
                        <img src="https://images.unsplash.com/photo-1620619767323-b95a89183081?q=80&w=600&auto=format&fit=crop"
                            alt="Architectural sketch">
                    </div>
                    <div class="zoom-item" data-layer="3">
                        <img src="https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?q=80&w=600&auto=format&fit=crop"
                            alt="Tech sketch marker">
                    </div>
                    <div class="zoom-item" data-layer="3">
                        <img src="https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?q=80&w=600&auto=format&fit=crop"
                            alt="Abstract fluid ink">
                    </div>
                    <div class="zoom-item" data-layer="1">
                        <img src="https://images.unsplash.com/photo-1513364776144-60967b0f800f?q=80&w=600&auto=format&fit=crop"
                            alt="Close up of marker tip">
                    </div>
                    <div class="zoom-item" data-layer="3">
                        <img src="https://images.unsplash.com/photo-1574169208507-84376144848b?q=80&w=600&auto=format&fit=crop"
                            alt="Graffiti style art">
                    </div>
                    <div class="zoom-item" data-layer="2">
                        <img src="https://images.unsplash.com/photo-1605721911519-3dfeb3be25e7?q=80&w=600&auto=format&fit=crop"
                            alt="Sketchbook flatlay">
                    </div>
                    <div class="zoom-item" data-layer="1">
                        <img src="https://images.unsplash.com/photo-1501504905252-473c47e087f8?q=80&w=600&auto=format&fit=crop"
                            alt="Coffee and doodles">
                    </div>
                </div>

                <section style="margin-bottom: -400px;" class="section-stick">
                    <p class="opacity-reveal reveal-text-style">
                        If you’re bold, a single marker stroke will break the grid, steal the show, and change
                        everything.
                    </p>
                </section>

                <!-- <div class="spacer-black"></div> -->
            </div>
            <div id="alice-wrapper">
                <section class="intro">
                    <h1 class="intro__heading">The Permanent Marker's<br />Bold Revolution</h1>
                </section>

                <section class="content">
                    <article class="article">
                        <h4><b>Origins</b></h4>
                        <p>THE ARTIST was beginning to get very tired of using thin pencils on the draft, and of having
                            no impact: once or twice she had dipped the brush into the ink pot her mentor was using, but
                            it had
                            no control or portability in it, “and what is the use of a tool,” thought the artist,
                            “without
                            boldness or permanence?”</p>
                        <p>She had dipped the brush into the ink pot her mentor was using, but it had
                            no control or portability in it, “and what is the use of a tool,” thought the artist,
                            “without
                            boldness or permanence?”</p>
                        <h4><b>Evolution</b></h4>
                        <p>THE ARTIST was beginning to get very tired of using thin pencils on the draft, and of having
                            no impact: once or twice she had dipped the brush into the ink pot her mentor was using, but
                            it had
                            no control or portability in it, “and what is the use of a tool,” thought the artist,
                            “without
                            boldness or permanence?”</p>
                        <p>A brush into the ink pot her mentor was using, but it had
                            no control or portability in it, “and what is the use of a tool,” thought the artist,
                            “without
                            boldness or permanence?”</p>
                    </article>
                </section>

                <div class="hero-reveal-wrapper">
                    <section class="hero-reveal">
                        <article>
                            <header class="hero-reveal__header">
                                <div class="hero-reveal_split">
                                    <div class="hero-reveal_split_item">
                                        <p>LIFELONG INK</p>
                                    </div>
                                    <div class="hero-reveal_split_item" aria-hidden="true">
                                        <p aria-hidden="true">LIFELONG INK</p>
                                    </div>
                                </div>
                            </header>

                            <div class="hero-reveal__content">
                                <div class="hero-reveal__content-inner">
                                    <div class="hero-reveal__parallax">
                                        <img src="https://assets.codepen.io/204808/alice-falling-1.png" alt="Alice"
                                            class="hero-reveal__parallax-alice" />
                                        <img width="150" src="https://assets.codepen.io/204808/alice-falling-clock.png"
                                            alt="Clock" class="hero-reveal__parallax-clock" />
                                        <img width="100" src="https://assets.codepen.io/204808/alice-falling-book.png"
                                            alt="Book" class="hero-reveal__parallax-book" />
                                        <img width="50" src="https://assets.codepen.io/204808/alice-falling-kattle.png"
                                            alt="Kattle" class="hero-reveal__parallax-kattle" />
                                        <img width="330" src="https://assets.codepen.io/204808/alice-falling-card.png"
                                            alt="Card" class="hero-reveal__parallax-card" />
                                    </div>

                                    <div class="hero-reveal__content-p">
                                        <p>Either the stroke was very broad, or it dried very quickly, for she had
                                            plenty of
                                            time as she drew to look about her, and to wonder what was going to
                                            be created next. First, she tried to look down and see where the line was
                                            coming
                                            to, but it was too dark to see underneath : then she looked at the tip of
                                            the pen, and noticed that it was filled with fibers and solvents:
                                            here and there she saw sketches and ideas hung upon walls.</p>
                                        <p>“Well!” thought the designer to herself, “after such a line as this, I shall
                                            think
                                            nothing of using cheap ballpoints! How brave they'll all think me at the
                                            studio!”
                                        </p>
                                        <p>Either the stroke was very broad, or it dried very quickly, for she had
                                            plenty of
                                            time as she drew to look about her, and to wonder what was going to
                                            be created next. First, she tried to look down and see where the line was
                                            coming
                                            to, but it was too dark to see underneath : then she looked at the tip of
                                            the pen, and noticed that it was filled with fibers and solvents:
                                            here and there she saw sketches and ideas hung upon walls.</p>
                                        <p>“Well!” thought the designer to herself, “after such a line as this, I shall
                                            think
                                            nothing of using cheap ballpoints! How brave they'll all think me at the
                                            studio!”
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </article>
                    </section>
                </div>

                <section class="content">
                    <article class="article">
                        <h4><b>Impact</b></h4>
                        <p>The ink was not a bit faded, and it stood out on the page in a moment : she looked down, but
                            it was all dried instantly; before her was another blank canvas, and the creative concept
                            was
                            still in sight, hurrying to capture it.</p>
                        <p>There were sketches all round the hall, but they were all rough, and when she had inked all
                            the way down one side and up the other, defining every shape, she walked proudly down the
                            middle,
                            wondering how she was ever to erase it again.</p>
                        <p>The ink was not a bit faded, and it stood out on the page in a moment : she looked down, but
                            it was all dried instantly; before her was another blank canvas, and the creative concept
                            was
                            still in sight, hurrying to capture it.</p>
                        <h4><b>Legacy</b></h4>

                        <p>There were sketches all round the hall, but they were all rough, and when she had inked all
                            the way down one side and up the other, defining every shape, she walked proudly down the
                            middle,
                            wondering how she was ever to erase it again.</p>
                        <p>There were sketches all round the hall, but they were all rough, and when she had inked all
                            the way down one side and up the other, defining every shape, she walked proudly down the
                            middle,
                            wondering how she was ever to erase it again.</p>
                    </article>
                </section>
            </div>
            <section id="carousel-section">
                <div class="slider">
                    <div class="slide dark" id="slide-1">
                        <div class="slide-img slide-img-1">
                            <img src="second.png" alt="Bold black marker stroke" />
                        </div>
                        <div class="slide-content">
                            <h1>Bold Strokes</h1>
                        </div>
                        <div class="slide-img slide-img-2">
                            <img src="firstt.png" alt="Abstract marker lines" />
                        </div>
                    </div>

                    <div class="slide light" id="slide-2">
                        <div class="slide-img slide-img-1">
                            <img src="second.png" alt="Vibrant marker blending" />
                        </div>
                        <div class="slide-content">
                            <h1 style="color: black;">Vibrant Flow</h1>
                        </div>
                        <div class="slide-img slide-img-2">
                            <img src="first.png" alt="Colorful alcohol markers" />
                        </div>
                    </div>

                    <div class="slide dark" id="slide-3">
                        <div class="slide-img slide-img-1">
                            <img src="second.png" alt="Paint marker drips" />
                        </div>
                        <div class="slide-content">
                            <h1>Street Ink</h1>
                        </div>
                        <div class="slide-img slide-img-2">
                            <img src="third.png" alt="Graffiti marker texture" />
                        </div>
                    </div>

                    <div class="slide light" id="slide-4">
                        <div class="slide-img slide-img-1">
                            <img src="first.png" alt="Architectural marker sketch" />
                        </div>
                        <div class="slide-content">
                            <h1 style="color: black;">Sketchbook</h1>
                        </div>
                        <div class="slide-img slide-img-2">
                            <img src="second.png" alt="Product design sketch" />
                        </div>
                    </div>

                </div>
                <div class="scroll-hint">Scroll down to explore</div>
            </section>
            <footer id="advanced-footer">
                <canvas id="footer-canvas"></canvas>
                <div class="footer-content">
                    <div class="footer-left">
                        <h2 class="footer-big-text">Marker<br>Digital.</h2>
                        <div style="font-size: 0.9rem; opacity: 0.6; margin-top: auto;">© 2025 All Rights Reserved.
                        </div>
                    </div>
                    <div class="footer-right">
                        <div class="footer-links">
                            <ul>
                                <li><a href="#">Work</a></li>
                                <li><a href="#">Studio</a></li>
                                <li><a href="#">News</a></li>
                            </ul>
                            <ul>
                                <li><a href="#">Instagram</a></li>
                                <li><a href="#">Twitter</a></li>
                                <li><a href="#">LinkedIn</a></li>
                            </ul>
                        </div>
                        <div class="footer-bottom">
                            <span>Kochi, India</span>
                            <span>Scroll to top ↑</span>
                        </div>
                    </div>
                </div>
            </footer>

        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/gsap@latest/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@latest/dist/ScrollTrigger.min.js"></script>

    <script>
        gsap.registerPlugin(ScrollTrigger);

        // --- 0. LOADER ANIMATION (OSMO/WILLEM) ---
        function initLoader() {
            const container = document.querySelector('.loader-screen');
            const loadingLetter = container.querySelectorAll('.willem__letter');
            const box = container.querySelectorAll('.willem-loader__box');
            const growingImage = container.querySelectorAll('.willem__growing-image');
            const headingStart = container.querySelectorAll('.willem__h1-start');
            const headingEnd = container.querySelectorAll('.willem__h1-end');
            const coverImageExtra = container.querySelectorAll('.willem__cover-image-extra');

            const tl = gsap.timeline({
                defaults: { ease: 'expo.inOut' },
                onComplete: () => {
                    document.body.classList.remove('is-loading');
                    gsap.to(container, {
                        opacity: 0,
                        display: 'none',
                        duration: 0.5,
                        onComplete: () => ScrollTrigger.refresh()
                    });
                }
            });

            if (loadingLetter) { tl.from(loadingLetter, { yPercent: 100, stagger: 0.025, duration: 1.25 }); }
            if (box.length) { tl.fromTo(box, { width: '0em' }, { width: '1em', duration: 1.25 }, '< 1.25'); }
            if (growingImage.length) { tl.fromTo(growingImage, { width: '0%' }, { width: '100%', duration: 1.25 }, '<'); }
            if (headingStart.length) { tl.fromTo(headingStart, { x: '0em' }, { x: '-0.05em', duration: 1.25 }, '<'); }
            if (headingEnd.length) { tl.fromTo(headingEnd, { x: '0em' }, { x: '0.05em', duration: 1.25 }, '<'); }
            if (coverImageExtra.length) { tl.fromTo(coverImageExtra, { opacity: 1 }, { opacity: 0, duration: 0.05, ease: 'none', stagger: 0.5 }, '-=0.05'); }
            if (growingImage.length) { tl.to(growingImage, { width: '100vw', height: '100vh', duration: 1.5 }, '< 1.25'); }
            if (box.length) { tl.to(box, { width: '100vw', duration: 1.5 }, '<'); }
        }

        document.addEventListener('DOMContentLoaded', () => {
            initLoader();
            initCarousel();
            initGlobalPageCursor();
            initFooterCursor();
            initFooterAnimations();
        });

        // --- GLOBAL PAGE CURSOR ANIMATION (NEW FUNCTION) ---
        function initGlobalPageCursor() {
            const globalCanvas = document.querySelector('#global-cursor-canvas');
            if (!globalCanvas) return;

            const globalCtx = globalCanvas.getContext('2d');
            let globalMouseMoved = false;

            const globalPointer = {
                x: 0.5 * window.innerWidth,
                y: 0.5 * window.innerHeight,
            };

            const params = {
                pointsNumber: 40,
                widthFactor: 0.3,
                mouseThreshold: 0.6,
                spring: 0.4,
                friction: 0.5,
            };

            const trail = new Array(params.pointsNumber);
            for (let i = 0; i < params.pointsNumber; i++) {
                trail[i] = {
                    x: globalPointer.x,
                    y: globalPointer.y,
                    dx: 0,
                    dy: 0,
                };
            }

            window.addEventListener('click', e => {
                updateGlobalMousePosition(e.clientX, e.clientY);
            });
            window.addEventListener('mousemove', e => {
                globalMouseMoved = true;
                updateGlobalMousePosition(e.clientX, e.clientY);
            });
            window.addEventListener('touchmove', e => {
                globalMouseMoved = true;
                updateGlobalMousePosition(e.targetTouches[0].clientX, e.targetTouches[0].clientY);
            });

            function updateGlobalMousePosition(eX, eY) {
                globalPointer.x = eX;
                globalPointer.y = eY;
            }

            function setupGlobalCanvas() {
                globalCanvas.width = window.innerWidth;
                globalCanvas.height = window.innerHeight;
            }

            function updateGlobal(t) {
                // Idle motion when mouse isn't moving
                if (!globalMouseMoved) {
                    globalPointer.x = (0.5 + 0.3 * Math.cos(0.002 * t) * Math.sin(0.005 * t)) * window.innerWidth;
                    globalPointer.y = (0.5 + 0.2 * Math.cos(0.005 * t) + 0.1 * Math.cos(0.01 * t)) * window.innerHeight;
                }

                globalCtx.clearRect(0, 0, globalCanvas.width, globalCanvas.height);

                trail.forEach((p, pIdx) => {
                    const prev = pIdx === 0 ? globalPointer : trail[pIdx - 1];
                    const spring = pIdx === 0 ? 0.4 * params.spring : params.spring;
                    p.dx += (prev.x - p.x) * spring;
                    p.dy += (prev.y - p.y) * spring;
                    p.dx *= params.friction;
                    p.dy *= params.friction;
                    p.x += p.dx;
                    p.y += p.dy;
                });

                globalCtx.lineCap = 'round';
                // Set color to white because we used mix-blend-mode: difference in CSS
                // This makes it look inverted on all backgrounds
                globalCtx.strokeStyle = '#ffffff';

                globalCtx.beginPath();
                globalCtx.moveTo(trail[0].x, trail[0].y);

                for (let i = 1; i < trail.length - 1; i++) {
                    const xc = 0.5 * (trail[i].x + trail[i + 1].x);
                    const yc = 0.5 * (trail[i].y + trail[i + 1].y);
                    globalCtx.quadraticCurveTo(trail[i].x, trail[i].y, xc, yc);
                    globalCtx.lineWidth = params.widthFactor * (params.pointsNumber - i);
                    globalCtx.stroke();
                }
                globalCtx.lineTo(trail[trail.length - 1].x, trail[trail.length - 1].y);
                globalCtx.stroke();

                window.requestAnimationFrame(updateGlobal);
            }

            window.addEventListener('resize', setupGlobalCanvas);

            // Initialize
            setupGlobalCanvas();
            updateGlobal(0);
        }

        // --- 1. URBANIST LOGIC ---
        const integrationSection = document.getElementById("urbanist-integration");
        const panes = gsap.utils.toArray(".pane");
        gsap.set(panes, { width: window.innerWidth });

        const themes = [
            { mainBg: "#b9dcff", subBg: "#f2fbfe", text: "#070f36", title: "#8dc9f4" },
            { mainBg: "#fff58c", subBg: "#fbf1ed", text: "#9c4e23", title: "#9c4e23" },
            { mainBg: "#c4ffb2", subBg: "#f1ffec", text: "#164c3b", title: "#164c3b" }
        ];

        const thresholds = new Array(panes.length).fill(0).map((_, i) => parseFloat(((1 / panes.length) * i).toFixed(2)));
        let activeThemeIndex = 0;

        gsap.to(panes, {
            xPercent: -100 * (panes.length - 1),
            ease: "none",
            scrollTrigger: {
                trigger: integrationSection,
                pin: true,
                scrub: 1,
                start: "top top",
                end: () => "+=" + (window.innerWidth * panes.length * 0.5),
                onUpdate: (self) => {
                    const progress = parseFloat(self.progress.toFixed(2));
                    const themeIndex = thresholds.findLastIndex((threshold) => progress >= threshold);
                    if (themeIndex !== activeThemeIndex && themeIndex >= 0) {
                        activeThemeIndex = themeIndex;
                        updateTheme(themeIndex);
                    }
                }
            }
        });

        function updateTheme(themeIndex) {
            const theme = themes[themeIndex];
            gsap.to(document.documentElement, {
                "--theme-main-bg": theme.mainBg,
                "--theme-sub-bg": theme.subBg,
                "--theme-title": theme.title,
                "--theme-text": theme.text,
                duration: 1,
                ease: "power2.out"
            });
        }

        // --- 2. PERSPECTIVE ZOOM LOGIC ---
        const zoomTimeline = gsap.timeline({
            scrollTrigger: {
                trigger: ".zoom-container",
                start: "top top",
                end: "+=200%",
                scrub: 1,
                pin: true
            }
        });
        zoomTimeline.to(".zoom-item[data-layer='3']", { z: 1000, opacity: 0, ease: "power1.in" }, 0);
        zoomTimeline.to(".zoom-item[data-layer='2']", { z: 600, opacity: 0, ease: "power1.in" }, 0.1);
        zoomTimeline.to(".zoom-item[data-layer='1']", { z: 300, opacity: 0, ease: "power1.in" }, 0.2);
        zoomTimeline.to(".heading-zoom", { z: 200, opacity: 1, scale: 1.5, ease: "power1.out" }, 0);

        // --- 3. TEXT REVEAL LOGIC ---
        const textElement = document.querySelector(".opacity-reveal");
        const textContent = textElement.innerText;
        textElement.innerHTML = '';
        textContent.split('').forEach(char => {
            const span = document.createElement('span');
            span.innerText = char;
            span.style.opacity = "0.1";
            textElement.appendChild(span);
        });
        const chars = textElement.querySelectorAll('span');
        const textTimeline = gsap.timeline({
            scrollTrigger: {
                trigger: ".section-stick",
                start: "center center",
                end: "+=150%",
                pin: true,
                scrub: 0.5
            }
        });
        textTimeline.to(chars, { opacity: 1, stagger: 0.02, duration: 1, ease: "none" })
            .to(textElement, { scale: 1.1, duration: 1, ease: "power2.out" }, "<");

        // --- 4. ALICE SECTION LOGIC ---
        const heroReveal = document.querySelectorAll(".hero-reveal");
        heroReveal.forEach((element) => {
            const heroBox = element.querySelector(".hero-reveal__header");
            const heroHeadings = element.querySelectorAll(".hero-reveal_split_item");
            const contentEl = element.querySelector(".hero-reveal__content");
            if (!heroBox || !contentEl) return;
            const heroBoxHeight = heroBox.offsetHeight;
            const contentHeight = contentEl.offsetHeight;
            const pinDistance = heroBoxHeight > contentHeight ? heroBoxHeight : contentHeight;

            gsap.fromTo(contentEl, { y: "50%" }, {
                y: "0%", ease: "none",
                scrollTrigger: { trigger: element, start: "top top", end: `+=${pinDistance}`, scrub: true }
            });

            const tl = gsap.timeline({ scrollTrigger: { trigger: element, start: "top top", end: `+=${pinDistance}`, scrub: true, pin: true } });
            tl.fromTo(heroBox, { clipPath: "inset(0% 0% 0% 0%)" }, { clipPath: "inset(0% 0% 100% 0%)", duration: 1, ease: "power1.inOut" });

            if (heroHeadings.length >= 2) {
                tl.fromTo(heroHeadings[0], { y: "0%" }, { y: "-30%", ease: "power1.inOut" }, 0);
                tl.fromTo(heroHeadings[1], { y: "0%" }, { y: "30%", ease: "power1.inOut" }, 0);
            }
        });

        function parallaxScrollBySpeed(selector, speed = 1, trigger = ".hero-reveal") {
            const el = document.querySelector(selector);
            const contentEl = document.querySelector(".hero-reveal__content");
            if (!el || !contentEl) return;
            const contentHeight = contentEl.offsetHeight;
            gsap.to(el, {
                yPercent: (speed - 1) * 100, ease: "none",
                scrollTrigger: { trigger: trigger, start: "top top", end: `+=${contentHeight * 2}`, scrub: true }
            });
        }
        parallaxScrollBySpeed(".hero-reveal__parallax-book", 15);
        parallaxScrollBySpeed(".hero-reveal__parallax-clock", 13);
        parallaxScrollBySpeed(".hero-reveal__parallax-alice", 6);
        parallaxScrollBySpeed(".hero-reveal__parallax-kattle", 23);
        parallaxScrollBySpeed(".hero-reveal__parallax-card", 5);

        // --- 5. CAROUSEL SECTION LOGIC (FIXED & STABLE) ---
        function initCarousel() {
            // We pin the section for 4000px.
            // We use a timeline that is scrubbed by the scroll.
            // This allows smooth forward/backward scrubbing with no logic errors.

            const carouselSection = document.querySelector("#carousel-section");
            const slides = gsap.utils.toArray(".slide"); // Get all pre-rendered slides

            // Create a timeline that spans the pinning duration
            const tl = gsap.timeline({
                scrollTrigger: {
                    trigger: carouselSection,
                    start: "top top",
                    end: "+=4000",
                    scrub: 1, // Smooth scrubbing, user can reverse easily
                    pin: true
                }
            });

            // The logic: Slide 1 is already visible.
            // We want to wipe Slide 2 over Slide 1, then Slide 3 over Slide 2, etc.
            // clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%) means FULLY VISIBLE.
            // clip-path: polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%) means HIDDEN AT BOTTOM.

            // 1. Reveal Slide 2
            tl.to("#slide-2", {
                clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
                duration: 1,
                ease: "none" // Linear ease for direct mapping to scroll
            });

            // 2. Reveal Slide 3
            tl.to("#slide-3", {
                clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
                duration: 1,
                ease: "none"
            });

            // 3. Reveal Slide 4
            tl.to("#slide-4", {
                clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
                duration: 1,
                ease: "none"
            });

            // Add a small buffer at the end so the user sees the last slide before unpinning
            tl.to({}, { duration: 0.5 });
        }

        // --- 6. FOOTER CURSOR LOGIC ---
        function initFooterCursor() {
            const canvas = document.querySelector('#footer-canvas');
            const footer = document.querySelector('#advanced-footer');
            if (!canvas || !footer) return;

            const ctx = canvas.getContext('2d');
            let mouseMoved = false;

            const pointer = { x: 0.5 * window.innerWidth, y: 0.5 * window.innerHeight };
            const params = {
                pointsNumber: 40,
                widthFactor: 0.3,
                mouseThreshold: 0.6,
                spring: 0.4,
                friction: 0.5,
            };

            const trail = new Array(params.pointsNumber);
            for (let i = 0; i < params.pointsNumber; i++) {
                trail[i] = { x: pointer.x, y: pointer.y, dx: 0, dy: 0 };
            }

            // Listen to movements on the FOOTER specifically to handle offsets correctly
            footer.addEventListener('mousemove', e => {
                mouseMoved = true;
                const rect = footer.getBoundingClientRect();
                // Calculate position relative to the footer canvas
                pointer.x = e.clientX - rect.left;
                pointer.y = e.clientY - rect.top;
            });

            // Also handle global window resizing
            window.addEventListener('resize', setupCanvas);

            function setupCanvas() {
                const rect = footer.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = rect.height;
            }

            function update(t) {
                // If mouse hasn't moved yet, create a gentle idle animation
                if (!mouseMoved) {
                    pointer.x = (0.5 + 0.3 * Math.cos(0.002 * t) * Math.sin(0.005 * t)) * canvas.width;
                    pointer.y = (0.5 + 0.2 * Math.cos(0.005 * t) + 0.1 * Math.cos(0.01 * t)) * canvas.height;
                }

                ctx.clearRect(0, 0, canvas.width, canvas.height);

                trail.forEach((p, pIdx) => {
                    const prev = pIdx === 0 ? pointer : trail[pIdx - 1];
                    const spring = pIdx === 0 ? 0.4 * params.spring : params.spring;
                    p.dx += (prev.x - p.x) * spring;
                    p.dy += (prev.y - p.y) * spring;
                    p.dx *= params.friction;
                    p.dy *= params.friction;
                    p.x += p.dx;
                    p.y += p.dy;
                });

                ctx.lineCap = 'round';
                ctx.strokeStyle = '#ffffff'; // White trail on black footer
                ctx.beginPath();
                ctx.moveTo(trail[0].x, trail[0].y);

                for (let i = 1; i < trail.length - 1; i++) {
                    const xc = 0.5 * (trail[i].x + trail[i + 1].x);
                    const yc = 0.5 * (trail[i].y + trail[i + 1].y);
                    ctx.quadraticCurveTo(trail[i].x, trail[i].y, xc, yc);
                    ctx.lineWidth = params.widthFactor * (params.pointsNumber - i);
                    ctx.stroke();
                }
                ctx.lineTo(trail[trail.length - 1].x, trail[trail.length - 1].y);
                ctx.stroke();

                window.requestAnimationFrame(update);
            }

            setupCanvas();
            update(0);
        }

        // --- 7. FOOTER REVEAL ANIMATIONS ---
        function initFooterAnimations() {
            const footer = document.querySelector('#advanced-footer');
            const bigText = footer.querySelector('.footer-big-text');
            const links = footer.querySelectorAll('.footer-links a');
            const bottom = footer.querySelector('.footer-bottom');

            // Animate Big Text
            gsap.to(bigText, {
                opacity: 1,
                y: 0,
                duration: 1.5,
                ease: "power3.out",
                scrollTrigger: {
                    trigger: footer,
                    start: "top 75%",
                }
            });

            // Animate Links Stagger
            gsap.to(links, {
                y: 0,
                duration: 1,
                stagger: 0.1,
                ease: "power3.out",
                scrollTrigger: {
                    trigger: footer,
                    start: "top 75%",
                }
            });

            // Animate Bottom Bar
            gsap.to(bottom, {
                opacity: 1,
                duration: 1,
                delay: 0.5,
                scrollTrigger: {
                    trigger: footer,
                    start: "top 80%",
                }
            });
        }
    </script>

    <script type="module">
        import LiquidBackground from 'https://cdn.jsdelivr.net/npm/threejs-components@0.0.27/build/backgrounds/liquid1.min.js'

        const canvasElement = document.getElementById('liquid-canvas');
        if (canvasElement) {
            const app = LiquidBackground(canvasElement)

            // Load the image and set parameters
            app.loadImage('https://assets.codepen.io/33787/liquid.webp')
            app.liquidPlane.material.metalness = 0.75
            app.liquidPlane.material.roughness = 0.25
            app.liquidPlane.uniforms.displacementScale.value = 5
            app.setRain(false)
        }
    </script>

    <script>
        const modelViewer = document.querySelector('#marker-3d-canvas');

        if(modelViewer) {
            gsap.to(modelViewer, {
                opacity: 0,
                ease: "none",
                scrollTrigger: {
                    trigger: "#urbanist-integration", // Trigger when Section 3 hits viewport
                    start: "top bottom", // Start fading when section 3 top hits bottom of screen
                    end: "top center",   // Finish fading when section 3 top hits center
                    scrub: true
                }
            });
        }
    </script>
</body>

</html>